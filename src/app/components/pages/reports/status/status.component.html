<div class="report-panel">

  <div class="fixed-header">
    <div class="breadcrumb-area">
      <h1>Device Connected Report</h1>
      <ol class="bredcrumb">
        <li>Reports</li>
        <li>Standard Reports</li>
        <li>Device</li>
        <li>Device Connected Report</li>
      </ol>
    </div>
  
    <div class="controls-container">
      <div class="search-container">
        <input type="text" class="search-input" [(ngModel)]="searchTerm" (input)="applyFilter()" placeholder="Search devices...">
        <button class="search-button"><i class="material-icons">search</i></button>
      </div>
      <button class="export-button" (click)="exportToExcel()">
        Export to Excel
      </button>
  
      <div class="column-manager">
        <button class="column-manager-button" (click)="columnList.classList.toggle('active')">
          <i class="material-icons">filter_list</i> Columns
        </button>
        <div class="column-list" #columnList>
          <label *ngFor="let column of columns; let i = index">
            <input type="checkbox" [checked]="column.visible" (change)="toggleColumn(column)">
            {{ column.label }}
          </label>
        </div>
      </div>
    </div>
  </div>

  <div class="table-container">
    <table class="user-table">
      <thead>
        <tr>
          <th *ngFor="let column of visibleColumns">{{ column.label }}</th>
        </tr>
      </thead>
      <tbody>
        <ng-container *ngIf="paginatedDevices && paginatedDevices.length > 0; else noData">
          <tr *ngFor="let device of paginatedDevices; let i = index" style="white-space: nowrap;">
            <td *ngFor="let column of visibleColumns"
                [ngClass]="{'pending': device[column.key] === 'PendingRegistration', 'inactive': device[column.key] === 'Inactive'}">
              <!-- <span *ngIf="column.key != 'view'"> {{ device[column.key] || 'N/A' }} </span> -->
              <span *ngIf="column.key === 'lastHeartBeat' && device[column.key]">{{ device[column.key] | date:'yyyy-MM-dd' }}</span>
              <span *ngIf="column.key !== 'lastHeartBeat' && column.key !== 'view'">
                {{ device[column.key] || 'N/A' }}
              </span>
              <span *ngIf="column.key == 'view'">
                <button mat-icon-button>
                  <mat-icon>visibility</mat-icon>
                </button>
              </span>
            </td>
          </tr>
        </ng-container>
        <ng-template #noData>
          <tr>
            <td [attr.colspan]="visibleColumns.length" class="no-data-message">No Data Available</td>
          </tr>
        </ng-template>
      </tbody>
    </table>

  <div class="pagination">
      <button class="pagination-button" (click)="previousPage()" [disabled]="currentPage === 1">Previous</button>
      <span class="pagination-info">Page {{ currentPage }} of {{ totalPages }}</span>
      <button class="pagination-button" (click)="nextPage()" [disabled]="currentPage === totalPages">Next</button>
      <div class="items-per-page">
        <label for="itemsPerPage">Items per page:</label>
        <select id="itemsPerPage" [(ngModel)]="itemsPerPage" (change)="updatePagination()">
          <option *ngFor="let option of itemsPerPageOptions" [value]="option">{{ option }}</option>
        </select>
      </div>
    </div>
    <div style="height: 50px;"></div>
</div>
</div>
